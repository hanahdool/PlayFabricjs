<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script src = "js/fabric.js"></script>
  <script src = "js/underscore.js"></script>
  <script src = "js/jquery.js"></script>
</head>
<body style="position:absolute">

<!--<div id="editor" ng-show="canvas.getActiveObject()" class="ng-hide">-->
  <!--<label style="margin-left:10px">Color : </label>-->
  <!--<input type="color" id="textColor">-->
<!--</div>-->

<canvas id="canvas" width="800" height="800" style="border: 1px solid black"></canvas>

<span>글씨색</span><input type="color" id="textColor"> <!-- value="#ff0000" 초기 색깔 -->
<span>배경색</span><input type="color" id="backgroundColor"> <!-- value="#ff0000" 초기 색깔 -->
<span>글씨배경색</span><input type="color" id="textBackgroundColor"> <!-- value="#ff0000" 초기 색깔 -->
<!--<button>글씨체</button>-->

<br>
<span>글자 테두리 : </span>
<span>색깔</span><input type="color" id="textStrokeColor">
<span>두께</span><input type="number" id="textStrokeWidth" value="0">

<br>
<span>padding</span><input type="number" id="padding" value="0" min="0"/> <!-- 음수값도 되긴 하넹.. -->
<br>
<button id="bold" onclick="fontWeight_bold()">B</button>
<button id="italic" onclick="fontStyle_italic()">I</button>
<br>
<button id="left" onclick="textAlign_left()">left</button>
<button id="center" onclick="textAlign_center()">center</button>
<button id="right" onclick="textAlign_right()">right</button>
<br>
<button id="underLine" onclick="textLine_under()">_</button>
<button id="middleLine" onclick="textLine_middle()">―</button>
<button id="overLine" onclick="textLine_over()">￣</button>


<script>


  // @ Done
  // 글씨 색 바꾸기
  // 글씨체 바꾸기
  // 정렬

  // @ To do
  // 전체 말고 부분적으로 속성 적용



  var canvas = new fabric.Canvas('canvas');

  // textbox, IText
  var text = new fabric.IText('가나다라마바사\nABCdefg\n123', {
    fontSize: 50,
    left: 50,
    top: 0,
    lineHeight: 1,
    originX: 'left',
    fontFamily: 'Helvetica',
    fontWeight: 'bold',
    statefullCache: true
  });
  canvas.add(text);





  // 텍스트 타입
//  text.setFontStyle("italic"); canvas.renderAll();
//  text.setFontStyle("normal"); canvas.renderAll();
//  text.setFontStyle("oblique"); canvas.renderAll();

  //두께
//  text.fontWeight("normal"); canvas.renderAll();
//  text.fontWeight("bold"); canvas.renderAll();

  // 글씨체
//  text.set({ fontFamily: "Helvetica" }); canvas.renderAll();
//  text.set({ fontFamily: "Cursive" }); canvas.renderAll();
//  text.set({ fontFamily: "Helvetica" }); canvas.renderAll();


  // 정렬
//  text.textAlign = "right"; canvas.renderAll();
//  text


  // line
//  "", "underline", "overline" or "line-through".
//  text.textDecoration = "underline"; canvas.renderAll();
//  text.textDecoration = "overline"; canvas.renderAll();
//  text.textDecoration = "line-through"; canvas.renderAll();
//  text.textDecoration = ""; canvas.renderAll();







  // 텍스트 추가
  function createText() {
    var text = new fabric.IText('글씨를 입력해주세요.', {
      fontSize: 50,
      left: 250,
      top: 250,
      lineHeight: 1,
      originX: 'left',
      fontFamily: 'Helvetica',
      fontWeight: 'bold',
      statefullCache: true
    });
    text.globalCompositeOperation = "source-atop";
    canvas.add(text);
  }



  // 색깔
  var textColor = document.getElementById("textColor");
  textColor.addEventListener("input", function() {
    canvas.getActiveObject().setColor(textColor.value);
    canvas.renderAll();
  });

  var backgroundColor = document.getElementById('backgroundColor');
  backgroundColor.addEventListener("input", function() {
//    text.setBackgroundColor(backgroundColor.value);
    canvas.getActiveObject().backgroundColor = backgroundColor.value;
    canvas.renderAll();
  });

  var textBackgroundColor = document.getElementById('textBackgroundColor');
  textBackgroundColor.addEventListener("input", function() {
    canvas.getActiveObject().textBackgroundColor = textBackgroundColor.value;
    canvas.renderAll();
  });


  // 글자 테두리 - 색깔
  $('#textStrokeColor').on('input', function(e) {
    console.log("글자 테두리 색깔 변경!");
    canvas.getActiveObject().setStroke(e.target.value);
//    canvas.getActiveObject()._setStrokeStyles(e.target.value);
    canvas.renderAll();
  });

  // 글자 테두리 - 두께
  $('#textStrokeWidth').on('input', function(e) {
    console.log("글자 테두리 두께 변경!");
    canvas.getActiveObject().setStrokeWidth(e.target.value);
//    canvas.getActiveObject()._setStrokeStyles(e.target.value);
    canvas.renderAll();
  });



  // 정렬
  function textAlign_left() {
    canvas.getActiveObject().textAlign = "left"; canvas.renderAll();
  }
  function textAlign_center() {
    canvas.getActiveObject().textAlign = "center"; canvas.renderAll();
  }
  function textAlign_right() {
    canvas.getActiveObject().textAlign = "right"; canvas.renderAll();
  }

  // 스타일
  function fontWeight_bold() {
    var text = canvas.getActiveObject();
    text.fontWeight = (text.fontWeight == "bold") ? "normal" : "bold";
    canvas.renderAll();
  }
  function fontStyle_italic() {
    var text = canvas.getActiveObject();
    text.setFontStyle((text.fontStyle == "italic") ? "" : "italic");
    canvas.renderAll();
  }

  // 라인
  function textLine_under() {
    var text = canvas.getActiveObject();
    text.textDecoration = (text.textDecoration == "underline") ? "" : "underline";
    canvas.renderAll();
  }
  function textLine_middle() {
    var text = canvas.getActiveObject();
    text.textDecoration = (text.textDecoration == "line-through") ? "" : "line-through";
    canvas.renderAll();
  }
  function textLine_over() {
    var text = canvas.getActiveObject();
    text.textDecoration = (text.textDecoration == "overline") ? "" : "overline";
    canvas.renderAll();
  }


  $('#padding').on('input', function(e) { // 근데 배경은 안채워짐 ㅜㅜ 뭐야이게
    text.padding = e.target.value;
    canvas.renderAll();
  });




</script>

</body>
</html>